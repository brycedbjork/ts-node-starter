{"version":3,"sources":["../../../src/services/notification/claimNotification.ts"],"names":["uid","jobId","chatId","jobData","chatData","claimingUser","hirer","id","hiringUser","notifications","jobs","push","body","firstName","type","data","text","message","email","userEmail"],"mappings":";;;;;;;AAGA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;AAGA;;;;;;;;0BAIe,iBACbA,GADa,EAEbC,KAFa,EAGbC,MAHa,EAIbC,OAJa,EAKbC,QALa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAORD,OAPQ;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAOiB,oBAAOF,KAAP,CAPjB;;AAAA;AAOCE,YAAAA,OAPD;;AAAA;AAAA,gBAQRC,QARQ;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAQmB,sBAAQF,MAAR,CARnB;;AAAA;AAQEE,YAAAA,QARF;;AAAA;AAAA;AAAA,mBAWc,sBAAQJ,GAAR,EAAa,SAAb,CAXd;;AAAA;AAWPK,YAAAA,YAXO;AAAA;AAAA,mBAYY,sBAAQF,OAAO,CAACG,KAAR,CAAcC,EAAtB,EAA0B,OAA1B,CAZZ;;AAAA;AAYPC,YAAAA,UAZO;;AAAA,kBAcTA,UAAU,CAACC,aAAX,IAA4BD,UAAU,CAACC,aAAX,CAAyBC,IAd5C;AAAA;AAAA;AAAA;;AAAA,iBAePF,UAAU,CAACC,aAAX,CAAyBC,IAAzB,CAA8BC,IAfvB;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAgBH,sBAAK;AACTX,cAAAA,GAAG,EAAHA,GADS;AAETY,cAAAA,IAAI,YAAKP,YAAY,CAACQ,SAAlB,2BAA4CV,OAAO,CAACW,IAApD,SAFK;AAGTC,cAAAA,IAAI,EAAE;AACJb,gBAAAA,MAAM,EAANA;AADI;AAHG,aAAL,CAhBG;;AAAA;AAAA,iBAwBPM,UAAU,CAACC,aAAX,CAAyBC,IAAzB,CAA8BM,IAxBvB;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAyBH,sBAAK;AACThB,cAAAA,GAAG,EAAHA,GADS;AAETiB,cAAAA,OAAO,YAAKZ,YAAY,CAACQ,SAAlB,2BACLV,OAAO,CAACW,IADH,yCAEwBZ,MAFxB;AAFE,aAAL,CAzBG;;AAAA;AAAA,iBAgCPM,UAAU,CAACC,aAAX,CAAyBC,IAAzB,CAA8BQ,KAhCvB;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAiCH,uBAAM;AACVlB,cAAAA,GAAG,EAAHA,GADU;AAEVc,cAAAA,IAAI,EAAE,YAFI;AAGVK,cAAAA,SAAS,EAAEX,UAAU,CAACU,KAHZ;AAIVjB,cAAAA,KAAK,EAALA,KAJU;AAKVE,cAAAA,OAAO,EAAPA;AALU,aAAN,CAjCG;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import { messaging, firestore } from \"../../firebase\";\nimport admin from \"firebase-admin\";\nimport { Job } from \"../../schemas/Job\";\nimport { getJob } from \"../job/getJob\";\nimport { getUser } from \"../user/getUser\";\nimport { getChat } from \"../chat/getChat\";\nimport push from \"./helpers/push\";\nimport text from \"./helpers/text\";\nimport email from \"./helpers/email\";\nimport { Chat } from \"../../schemas/Chat\";\n\n/*\nSends notification to hirer that student has claimed their job\n*/\n\nexport default async (\n  uid: string,\n  jobId: string,\n  chatId: string,\n  jobData?: Job,\n  chatData?: Chat\n) => {\n  if (!jobData) jobData = await getJob(jobId);\n  if (!chatData) chatData = await getChat(chatId);\n\n  // get users\n  const claimingUser = await getUser(uid, \"student\");\n  const hiringUser = await getUser(jobData.hirer.id, \"hirer\");\n\n  if (hiringUser.notifications && hiringUser.notifications.jobs) {\n    if (hiringUser.notifications.jobs.push) {\n      await push({\n        uid,\n        body: `${claimingUser.firstName} claimed your ${jobData.type} job`,\n        data: {\n          chatId\n        }\n      });\n    }\n    if (hiringUser.notifications.jobs.text) {\n      await text({\n        uid,\n        message: `${claimingUser.firstName} claimed your ${\n          jobData.type\n        } job\\nhireastudent.org/chat/${chatId}`\n      });\n    }\n    if (hiringUser.notifications.jobs.email) {\n      await email({\n        uid,\n        type: \"jobClaimed\",\n        userEmail: hiringUser.email,\n        jobId,\n        jobData\n      });\n    }\n  }\n};\n"],"file":"claimNotification.js"}