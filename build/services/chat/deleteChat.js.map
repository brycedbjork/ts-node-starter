{"version":3,"sources":["../../../src/services/chat/deleteChat.ts"],"names":["deleteChat","chatId","firestore","collection","doc","get","chatDoc","exists","Error","req","res","body","status","send","console","log","Sentry","captureException"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;AAGA,IAAMA,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,iBAAOC,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEKC,oBACnBC,UADmB,CACR,MADQ,EAEnBC,GAFmB,CAEfH,MAFe,EAGnBI,GAHmB,EAFL;;AAAA;AAEXC,YAAAA,OAFW;;AAAA,gBAMZA,OAAO,CAACC,MANI;AAAA;AAAA;AAAA;;AAAA,kBAOT,IAAIC,KAAJ,CAAU,qBAAV,CAPS;;AAAA;AAAA;AAAA,mBAWXN,oBACHC,UADG,CACQ,OADR,EAEHC,GAFG,CAECH,MAFD,aAXW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAVD,UAAU;AAAA;AAAA;AAAA,GAAhB;;;;;;;0BAiBe,kBAAOS,GAAP,EAAiBC,GAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEHT,YAAAA,MAFG,GAE4BQ,GAAG,CAACE,IAFhC,CAEHV,MAFG;AAAA;AAAA,mBAILD,UAAU,CAACC,MAAD,CAJL;;AAAA;AAAA,8CAMJS,GAAG,CAACE,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,EANI;;AAAA;AAAA;AAAA;AAYXH,YAAAA,GAAG,CAACE,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,kBAArB;AACAC,YAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ;AACAC,YAAAA,MAAM,CAACC,gBAAP;;AAdW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import { auth, firestore, messaging } from \"../../firebase\";\nimport * as Sentry from \"@sentry/node\";\nimport { Chat } from \"../../schemas/Chat\";\n\nconst deleteChat = async (chatId: string) => {\n  // get job entity\n  const chatDoc = await firestore\n    .collection(\"jobs\")\n    .doc(chatId)\n    .get();\n  if (!chatDoc.exists) {\n    throw new Error(\"Chat does not exist\");\n  }\n\n  // delete job itself\n  await firestore\n    .collection(\"chats\")\n    .doc(chatId)\n    .delete();\n};\n\nexport default async (req: any, res: any) => {\n  try {\n    const { chatId }: { chatId: string } = req.body;\n\n    await deleteChat(chatId);\n\n    return res.status(200).send();\n\n    // TODO: notify matched students?\n\n    // success\n  } catch (error) {\n    res.status(500).send(\"Something broke!\");\n    console.log(\"Error: \" + error);\n    Sentry.captureException(error);\n  }\n};\n"],"file":"deleteChat.js"}